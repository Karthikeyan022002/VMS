<div class="container mt-5">
  <h2 class="text-center text-primary mb-4">View Bookings</h2>

  <!-- User Bookings -->
  <div class="card mb-4">
    <div class="card-header bg-info text-white">
      My Bookings
    </div>
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-bordered table-striped table-hover align-middle mb-0">
          <thead class="table-dark">
            <tr>
              <th>Name</th>
              <th>Vaccine</th>
              <th>Date</th>
              <th>Location</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let booking of userBookings; let i = index">
              <td>{{ userName }}</td>
              <td>{{ booking.vaccine || booking.vaccineName }}</td>
              <td>{{ booking.date || booking.slotDate | date:'medium' }}</td>
              <td>{{ booking.location || booking.city || booking.locationCity }}</td>
              <td>
                <div class="d-flex flex-wrap gap-1 justify-content-center">
                  <button type="button" class="btn btn-outline-danger btn-sm" (click)="deleteUserBooking(i)">Delete</button>
                  <button type="button" class="btn btn-outline-primary btn-sm" (click)="openRescheduleModal(booking, 'user', i)">Reschedule</button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Family Bookings -->
  <div class="card">
    <div class="card-header bg-info text-white">
      Family Bookings
    </div>
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-bordered table-striped table-hover align-middle mb-0">
          <thead class="table-dark">
            <tr>
              <th>Name</th>
              <th>Vaccine Type</th>
              <th>Slot Date</th>
              <th>Vaccination Center</th>
              <th>State</th>
              <th>City</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let booking of familyBookings; let i = index">
              <td>{{ booking.memberName || booking.fullName }}</td>
              <td>{{ booking.vaccineName || booking.vaccine || booking.vaccine_type }}</td>
              <td>{{ booking.slotDate || booking.date | date:'medium' }}</td>
              <td>{{ booking.vaccinationCenterName || booking.centerName }}</td>
              <td>{{ booking.locationState || booking.state }}</td>
              <td>{{ booking.locationCity || booking.city }}</td>
              <td>
                <div class="d-flex flex-wrap gap-1 justify-content-center">
                  <button type="button" class="btn btn-outline-danger btn-sm" (click)="deleteFamilyBooking(i)">Delete</button>
                  <button type="button" class="btn btn-outline-primary btn-sm" (click)="openRescheduleModal(booking, 'family', i)">Reschedule</button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Reschedule Modal -->
  <div class="modal" tabindex="-1" [ngClass]="{'show d-block': showRescheduleModal}" *ngIf="showRescheduleModal">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Reschedule Booking</h5>
          <button type="button" class="btn-close" (click)="closeRescheduleModal()"></button>
        </div>
        <div class="modal-body">
          <form (ngSubmit)="submitReschedule()">
            <div class="mb-3">
              <label for="slotSelect" class="form-label">Select New Slot</label>
              <select id="slotSelect" class="form-select" [(ngModel)]="selectedSlotId" name="slotSelect" required>
                <option *ngFor="let slot of slots" [value]="slot.slotId">
                  {{ slot.vaccineName }} - {{ slot.locationCity }}, {{ slot.locationState }} ({{ slot.slotDate | date:'medium' }})
                </option>
              </select>
            </div>
            <button type="submit" class="btn btn-primary">Reschedule</button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>