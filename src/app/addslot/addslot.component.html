<div class="container mt-5">
  <h2 class="text-center text-primary mb-4">Availability Update</h2>
 
  <div class="table-responsive">
    <table class="vaccine-table table table-bordered">
      <thead>
        <tr>
          <th>State</th>
          <th>City</th>
          <th>Vaccine</th>
          <th>Slots</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <ng-container *ngFor="let state of getStates()">
          <ng-container *ngFor="let city of getCities(state)">
            <ng-container *ngFor="let vaccine of getVaccines(state, city)">
              <tr>
                <!-- State Column -->
                <td *ngIf="!isEditingRow(state, city, vaccine)">{{ state }}</td>
                <td *ngIf="isEditingRow(state, city, vaccine)">
                  <input [(ngModel)]="editState" class="form-control" />
                </td>
 
                <!-- City Column -->
                <td *ngIf="!isEditingRow(state, city, vaccine)">{{ city }}</td>
                <td *ngIf="isEditingRow(state, city, vaccine)">
                  <input [(ngModel)]="editCity" class="form-control" />
                </td>
 
                <!-- Vaccine Column -->
                <td *ngIf="!isEditingRow(state, city, vaccine)">{{ vaccine }}</td>
                <td *ngIf="isEditingRow(state, city, vaccine)">
                  <input [(ngModel)]="editVaccine" class="form-control" />
                </td>
 
                <!-- Slot Column -->
                <td *ngIf="!isEditingRow(state, city, vaccine)">
                  <ul class="mb-0 pl-3">
                    <li *ngFor="let slot of vaccineData[state][city][vaccine]">{{ slot }}</li>
                  </ul>
                </td>
                <td *ngIf="isEditingRow(state, city, vaccine)">
                  <select multiple [(ngModel)]="editSlots" class="form-control">
                    <option *ngFor="let slot of slotOptions" [value]="slot">{{ slot }}</option>
                  </select>
                </td>
 
                <!-- Action Column -->
                <td class="action-links">
                  <a href="#" class="text-primary" (click)="startEditing(state, city, vaccine); $event.preventDefault()">Edit</a>
                  <a href="#" class="text-danger" (click)="deleteRow(state, city, vaccine); $event.preventDefault()">Delete</a>
                  <a *ngIf="isEditingRow(state, city, vaccine)" href="#" class="text-success" (click)="saveRow(state, city, vaccine); $event.preventDefault()">Save</a>
                  <a *ngIf="isEditingRow(state, city, vaccine)" href="#" class="text-secondary" (click)="cancelEdit(); $event.preventDefault()">Cancel</a>
                </td>
              </tr>
            </ng-container>
          </ng-container>
        </ng-container>
 
        <!-- Add Row Section -->
        <tr *ngIf="isAdding">
          <td><input class="form-control" [(ngModel)]="newState" placeholder="Enter State" /></td>
          <td><input class="form-control" [(ngModel)]="newCity" placeholder="Enter City" /></td>
          <td><input class="form-control" [(ngModel)]="newVaccine" placeholder="Enter Vaccine" /></td>
          <td>
            <select multiple [(ngModel)]="newSlots" class="form-control">
              <option *ngFor="let slot of slotOptions" [value]="slot">{{ slot }}</option>
            </select>
          </td>
          <td class="action-links">
            <a href="#" class="text-success" (click)="saveNewRow(); $event.preventDefault()">Save</a>
            <a href="#" class="text-secondary" (click)="cancelAdd(); $event.preventDefault()">Cancel</a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
 
  <!-- Button Below Table -->
  <div class="update-button-wrapper mt-3 text-center">
    <button class="btn btn-primary" (click)="startAdding()" [disabled]="isAdding">Add Row</button>
  </div>
</div>